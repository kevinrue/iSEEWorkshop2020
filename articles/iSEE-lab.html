<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive visualization of SummarizedExperiment objects with iSEE • iSEEWorkshop2020</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Interactive visualization of SummarizedExperiment objects with iSEE">
<meta property="og:description" content="iSEEWorkshop2020">
<meta property="og:image" content="https://iSEE.github.io/iSEEWorkshop2020/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iSEEWorkshop2020</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/iSEE-lab.html">Interactive visualization of SummarizedExperiment objects with iSEE</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iSEE/iSEEWorkshop2020">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="iSEE-lab_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="iSEE-lab_files/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="iSEE-lab_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interactive visualization of SummarizedExperiment objects with iSEE</h1>
                        <h4 class="author">Kevin Rue-Albrecht, Charlotte Soneson, Federico Marini, and Aaron Lun</h4>
            
            <h4 class="date">July 17, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/iSEE/iSEEWorkshop2020/blob/master/vignettes/iSEE-lab.Rmd"><code>vignettes/iSEE-lab.Rmd</code></a></small>
      <div class="hidden name"><code>iSEE-lab.Rmd</code></div>

    </div>

    
    
<!-- Fix until BiocStyle is updated with this style. -->
<style>
td > img {
  padding: 0px;
  max-width: 100%;
  display: inline;
}
</style>
<div id="instructor-and-contributor-names-and-contact-information" class="section level1">
<h1 class="hasAnchor">
<a href="#instructor-and-contributor-names-and-contact-information" class="anchor"></a>Instructor and contributor names and contact information</h1>
<ul>
<li>Kevin Rue-Albrecht<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> (<a href="mailto:kevin.rue-albrecht@ndcls.ox.ac.uk" class="email">kevin.rue-albrecht@ndcls.ox.ac.uk</a>)</li>
<li>Charlotte Soneson<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> (<a href="mailto:charlotte.soneson@fmi.ch" class="email">charlotte.soneson@fmi.ch</a>)</li>
<li>Federico Marini<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> (<a href="mailto:marinif@uni-mainz.de" class="email">marinif@uni-mainz.de</a>)</li>
<li>Aaron Lun<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> (<a href="mailto:infinite.monkeys.with.keyboards@gmail.com" class="email">infinite.monkeys.with.keyboards@gmail.com</a>)</li>
</ul>
</div>
<div id="workshop-description" class="section level1">
<h1 class="hasAnchor">
<a href="#workshop-description" class="anchor"></a>Workshop description</h1>
<p>This workshop demonstrates how to use the <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> package to create and configure interactive applications for the exploration of various types of genomics data sets (e.g., bulk and single-cell RNA-seq, CyTOF, gene expression microarray).</p>
<p>This workshop will be presented as a lab session that combines an instructor-led live demo, followed by hands-on experimentation guided by completely worked examples and stand-alone notes that participants may continue to use after the workshop.</p>
<p>The instructor-led live demo comprises three parts:</p>
<ol style="list-style-type: decimal">
<li>Brief lecture on the package concept and functionality</li>
<li>Overview of the graphical user interface</li>
<li>Instructions to preconfigure <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> apps</li>
</ol>
<p>The hands-on lab comprises three parts:</p>
<ol style="list-style-type: decimal">
<li>Inspection of single-cell RNA-seq data at various steps of a typical computational workflow, including quality control and dimensionality reduction</li>
<li>Addition of custom panels to the user interface for advanced visualization.</li>
<li>Additional questions from the participants, including individual use cases and suggestions for future developments</li>
</ol>
<p>Participants are encouraged to ask questions at any time during the workshop.</p>
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Pre-requisites</h2>
<ul>
<li>Basic knowledge of <em>R</em> (<a href="https://www.r-project.org/about.html" class="uri">https://www.r-project.org/about.html</a>) syntax and the use of data frames</li>
<li>Familiarity with the <em><a href="https://bioconductor.org/packages/3.12/SummarizedExperiment">SummarizedExperiment</a></em> and <em><a href="https://bioconductor.org/packages/3.12/SingleCellExperiment">SingleCellExperiment</a></em> classes</li>
<li>Familiarity with the <em><a href="https://CRAN.R-project.org/package=shiny">shiny</a></em> CRAN package</li>
<li>Familiarity with the <em><a href="https://bioconductor.org/packages/3.12/TENxPBMCData">TENxPBMCData</a></em> package and vignette</li>
</ul>
<p>Additional background reading about the programming environment, relevant packages, and example use cases:</p>
<ul>
<li>Shiny from RStudio (<a href="https://shiny.rstudio.com" class="uri">https://shiny.rstudio.com</a>)</li>
<li>SummarizedExperiment paper: <span class="citation">(Huber et al. 2015)</span> (Figure 2)</li>
<li>iSEE paper: <span class="citation">(Rue-Albrecht et al. 2018)</span>
</li>
</ul>
</div>
<div id="participation" class="section level2">
<h2 class="hasAnchor">
<a href="#participation" class="anchor"></a>Workshop Participation</h2>
<p>Students will participate by following along an <em>R markdown</em> (<a href="https://rmarkdown.rstudio.com/" class="uri">https://rmarkdown.rstudio.com/</a>) document, and asking questions throughout the workshop. There is also scope for participants to apply <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> to their own data sets, and fuel the discussion with more questions about specific use cases.</p>
</div>
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>R/Bioconductor packages used</h2>
<ol style="list-style-type: decimal">
<li><em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/SummarizedExperiment">SummarizedExperiment</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/SingleCellExperiment">SingleCellExperiment</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/TENxPBMCData">TENxPBMCData</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/scater">scater</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/scran">scran</a></em></li>
<li><em><a href="https://bioconductor.org/packages/3.12/BiocSingular">BiocSingular</a></em></li>
</ol>
</div>
<div id="outline" class="section level2">
<h2 class="hasAnchor">
<a href="#outline" class="anchor"></a>Time outline</h2>
<table class="table">
<thead><tr class="header">
<th>Activity</th>
<th>Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Lecture</strong>: Overview of package and concepts</td>
<td>15m</td>
</tr>
<tr class="even">
<td>
<strong>Live demo</strong>: the user interface</td>
<td>15m</td>
</tr>
<tr class="odd">
<td>
<strong>Lab</strong>: A single-cell RNA-seq workflow</td>
<td>20m</td>
</tr>
<tr class="even">
<td>
<strong>Lab</strong>: Configuring the app interface</td>
<td>20m</td>
</tr>
<tr class="odd">
<td>
<strong>Lab</strong>: Custom panels</td>
<td>20m</td>
</tr>
<tr class="even">
<td>Additional questions</td>
<td>15m</td>
</tr>
</tbody>
</table>
<p><strong>Total:</strong> 1h45</p>
</div>
</div>
<div id="goals-objectives" class="section level1">
<h1 class="hasAnchor">
<a href="#goals-objectives" class="anchor"></a>Workshop goals and objectives</h1>
<div id="goals" class="section level2">
<h2 class="hasAnchor">
<a href="#goals" class="anchor"></a>Learning goals</h2>
<ul>
<li>Recognize the benefits of integrative data containers such as <em><a href="https://bioconductor.org/packages/3.12/SummarizedExperiment">SummarizedExperiment</a></em> and <em><a href="https://bioconductor.org/packages/3.12/SingleCellExperiment">SingleCellExperiment</a></em> for downstream analyses and visualization</li>
<li>Outline the unique features of <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> built upon the RStudio Shiny framework (<a href="https://shiny.rstudio.com" class="uri">https://shiny.rstudio.com</a>)</li>
<li>Identify aspects of biological data that may be combined into insightful graphical outputs</li>
<li>Utilize interactive GUI components and layouts to efficiently extract information from biological data sets</li>
<li>Describe how to construct interactive apps and custom panels</li>
</ul>
</div>
<div id="objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#objectives" class="anchor"></a>Learning objectives</h2>
<ul>
<li>Memorize the key information available in <em><a href="https://bioconductor.org/packages/3.12/SummarizedExperiment">SummarizedExperiment</a></em> and <em><a href="https://bioconductor.org/packages/3.12/SingleCellExperiment">SingleCellExperiment</a></em> objects</li>
<li>Set up a local environment for running <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> apps</li>
<li>Interact with components of the <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> user interface to visually inspect and discuss various data sets</li>
<li>Identify and locate configurable aspects of <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> apps</li>
<li>Practice interactive visualization over a single-cell RNA-sequencing workflow</li>
<li>Design custom <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> panels for advanced use cases</li>
<li>Imagine use cases and future developments for interactive visualization as part of computational workflows</li>
</ul>
</div>
</div>
<div id="prepare-scrnaseq-data" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-scrnaseq-data" class="anchor"></a>Preparation of example scRNAseq data</h1>
<p>In this workshop, we use example data from the <em><a href="https://bioconductor.org/packages/3.12/TENxPBMCData">TENxPBMCData</a></em> package. This package provides an <em>R / Bioconductor</em> resource for representing and manipulating different single-cell RNA-seq data sets profiling peripheral blood mononuclear cells (PBMC) generated by 10x Genomics (<a href="https://support.10xgenomics.com/single-cell-gene-expression/datasets" class="uri">https://support.10xgenomics.com/single-cell-gene-expression/datasets</a>).</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">TENxPBMCData</span>)</pre></body></html></div>
<p>The man page for the <code><a href="https://rdrr.io/pkg/TENxPBMCData/man/TENxPBMCData.html">TENxPBMCData()</a></code> function gives an idea of the datasets that are available from this package. It can be opened with the following command.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span>(<span class="no">TENxPBMCData</span>)</pre></body></html></div>
<p>Here, we use the <code>pbmc3k</code> dataset, which contains gene expression profiles for 2,700 single peripheral blood mononuclear cells. The first time this dataset is loaded, this command downloads the dataset to a local cache, which takes some time, depending on the speed of your internet connection. Subsequent times, the same command loads the dataset directly from the local cache.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">sce</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TENxPBMCData/man/TENxPBMCData.html">TENxPBMCData</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="st">"pbmc3k"</span>)</pre></body></html></div>
<p>At this point we can inspect the dataset in the console.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">sce</span>
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2700 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(32738): ENSG00000243485 ENSG00000237613 ... ENSG00000215616</span>
<span class="co">#&gt;   ENSG00000215611</span>
<span class="co">#&gt; rowData names(3): ENSEMBL_ID Symbol_TENx Symbol</span>
<span class="co">#&gt; colnames: NULL</span>
<span class="co">#&gt; colData names(11): Sample Barcode ... Individual Date_published</span>
<span class="co">#&gt; reducedDimNames(0):</span>
<span class="co">#&gt; altExpNames(0):</span></pre></body></html></div>
<p>The dataset is provided as an object of the <code>SingleCellExperiment</code> class. In particular, this summary view indicates that the following pieces of information are available:</p>
<ul>
<li>An assay matrix named <code>counts</code>
</li>
<li>Row (i.e., gene) names are Ensembl gene IDs</li>
<li>Row metadata include for each gene the official gene symbol, and the gene symbol used by the 10x CellRanger quantification pipeline</li>
<li>Column (i.e., cell) IDs are not initialized and left to <code>NULL</code>
</li>
<li>Column metadata include diverse information for each cell, including the cell barcode (<code>Barcode</code>) and the donor identifier (<code>Individual</code>).</li>
</ul>
<p>Note that a <code>SingleCellExperiment</code> object (or, more generally, any <code>SummarizedExperiment</code> object) like this one already contains sufficient information to launch an interactive application instance to visualize the available data and metadata, using the <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code> function.</p>
<p>For the purpose of this workshop, we first apply some preprocessing to the <code>SingleCellExperiment</code> object, in order to populate it with more information that can be visualized with <code>iSEE</code>.</p>
<p>We start by adding column names to the object, and use gene symbols instead of Ensembl IDs as row names. In the case where multiple Ensembl identifiers correspond to the same gene symbol, the <code><a href="https://rdrr.io/pkg/scater/man/reexports.html">scater::uniquifyFeatureNames</a></code> function concatenates the Ensembl ID and the gene symbol in order to generate unique feature names.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scater</span>)
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.1</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">sce</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Cell"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">sce</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>) <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/reexports.html">uniquifyFeatureNames</a></span>(
    <span class="kw">ID</span> <span class="kw">=</span> <span class="fu">rowData</span>(<span class="no">sce</span>)$<span class="no">ENSEMBL_ID</span>,
    <span class="kw">names</span> <span class="kw">=</span> <span class="fu">rowData</span>(<span class="no">sce</span>)$<span class="no">Symbol_TENx</span>
)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>))
<span class="co">#&gt; [1] "MIR1302-10"   "FAM138A"      "OR4F5"        "RP11-34P13.7" "RP11-34P13.8"</span>
<span class="co">#&gt; [6] "AL627309.1"</span></pre></body></html></div>
<p>Next, we use the <em><a href="https://bioconductor.org/packages/3.12/scater">scater</a></em> package to calculate gene- and cell-level quality metrics. These metrics are added as columns to the <code>rowData</code> and <code>colData</code> slots of the <code>SingleCellExperiment</code> object, respectively. We also add some additional metrics that are not automatically computed by the <em><a href="https://bioconductor.org/packages/3.12/scater">scater</a></em> package.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">MT</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>)[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"^MT-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>))]
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/reexports.html">addPerCellQC</a></span>(<span class="no">sce</span>, <span class="kw">subsets</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">MT</span> <span class="kw">=</span> <span class="no">MT</span>))
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/reexports.html">addPerFeatureQC</a></span>(<span class="no">sce</span>)
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>

<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="no">sce</span>$<span class="no">log10_total</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">sce</span>$<span class="no">total</span>)
<span class="fu">rowData</span>(<span class="no">sce</span>)$<span class="no">n_cells</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu">rowData</span>(<span class="no">sce</span>)$<span class="no">detected</span> * <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">sce</span>))
<span class="fu">rowData</span>(<span class="no">sce</span>)$<span class="no">log10_total</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="fu">assay</span>(<span class="no">sce</span>, <span class="st">"counts"</span>)) + <span class="fl">1</span>)
<span class="no">sce</span>
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2700 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(32738): MIR1302-10 FAM138A ... AC002321.2 AC002321.1</span>
<span class="co">#&gt; rowData names(7): ENSEMBL_ID Symbol_TENx ... n_cells log10_total</span>
<span class="co">#&gt; colnames(2700): Cell1 Cell2 ... Cell2699 Cell2700</span>
<span class="co">#&gt; colData names(18): Sample Barcode ... total log10_total</span>
<span class="co">#&gt; reducedDimNames(0):</span>
<span class="co">#&gt; altExpNames(0):</span></pre></body></html></div>
<p>We filter out a few cells with a large fraction of the counts coming from mitochondrial genes, since these may be damaged cells. Notice the reduced number of columns in the dataset below.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">(<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="no">sce</span>[, <span class="no">sce</span>$<span class="no">subsets_MT_percent</span> <span class="kw">&lt;</span> <span class="fl">5</span>])
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2643 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(32738): MIR1302-10 FAM138A ... AC002321.2 AC002321.1</span>
<span class="co">#&gt; rowData names(7): ENSEMBL_ID Symbol_TENx ... n_cells log10_total</span>
<span class="co">#&gt; colnames(2643): Cell1 Cell2 ... Cell2699 Cell2700</span>
<span class="co">#&gt; colData names(18): Sample Barcode ... total log10_total</span>
<span class="co">#&gt; reducedDimNames(0):</span>
<span class="co">#&gt; altExpNames(0):</span></pre></body></html></div>
<p>Next, we calculate size factors and normalized and log-transformed expression values, using the <em><a href="https://bioconductor.org/packages/3.12/scran">scran</a></em> and <em><a href="https://bioconductor.org/packages/3.12/scater">scater</a></em> packages. Note that it is typically recommended to pre-cluster the cells before computing the size factors, as follows:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"># set.seed(1000)
# clusters &lt;- scran::quickCluster(sce, BSPARAM = IrlbaParam())
# sce &lt;- scran::computeSumFactors(sce, cluster = clusters, min.mean = 0.1)</pre></body></html></div>
<p>However, for time reasons, we will skip the pre-clustering step in this workshop.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scran</span>)
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scran</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scran/man/computeSumFactors.html">computeSumFactors</a></span>(<span class="no">sce</span>, <span class="kw">min.mean</span> <span class="kw">=</span> <span class="fl">0.1</span>)
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu">sizeFactors</span>(<span class="no">sce</span>))
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.1164  0.7309  0.9004  1.0000  1.1635  9.8580</span>
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/reexports.html">logNormCounts</a></span>(<span class="no">sce</span>)</pre></body></html></div>
<p>In order to extract the most informative genes, we first model the mean-variance trend and decompose the variance into biological and technical components.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">dec</span> <span class="kw">&lt;-</span> <span class="kw pkg">scran</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scran/man/modelGeneVar.html">modelGeneVar</a></span>(<span class="no">sce</span>)
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="no">top.dec</span> <span class="kw">&lt;-</span> <span class="no">dec</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">dec</span>$<span class="no">bio</span>, <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>), ]
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">top.dec</span>)
<span class="co">#&gt; DataFrame with 6 rows and 6 columns</span>
<span class="co">#&gt;              mean     total      tech       bio      p.value          FDR</span>
<span class="co">#&gt;         &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;    &lt;numeric&gt;    &lt;numeric&gt;</span>
<span class="co">#&gt; LYZ       1.63950   3.92209  0.884955   3.03713 4.59557e-117 2.54472e-113</span>
<span class="co">#&gt; S100A9    1.07323   3.36899  0.778205   2.59079 2.72222e-110 9.04431e-107</span>
<span class="co">#&gt; HLA-DRA   1.56937   3.16577  0.880146   2.28562  5.73028e-68  7.93262e-65</span>
<span class="co">#&gt; FTL       3.67846   2.88499  0.708226   2.17676  2.46520e-94  5.85028e-91</span>
<span class="co">#&gt; CD74      2.23653   2.75839  0.854474   1.90392  1.34728e-50  1.01732e-47</span>
<span class="co">#&gt; CST3      1.10995   2.59172  0.790231   1.80149  7.24671e-53  6.01912e-50</span></pre></body></html></div>
<p>Next, we apply Principal Components Analysis (PCA) and t-distributed Stochastic Neighbor Embedding (t-SNE) to generate low-dimensional representations of the cells in our data set. These low-dimensional representations are added to the <code>reducedDim</code> slot of the <code>SingleCellExperiment</code> object.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BiocSingular</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1000</span>)
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scran</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scran/man/denoisePCA.html">denoisePCA</a></span>(<span class="no">sce</span>, <span class="kw">technical</span> <span class="kw">=</span> <span class="no">dec</span>)
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="fu">reducedDim</span>(<span class="no">sce</span>, <span class="st">"PCA"</span>))
<span class="co">#&gt; [1] 5</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1000</span>)
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span>(<span class="no">sce</span>, <span class="kw">dimred</span> <span class="kw">=</span> <span class="st">"PCA"</span>, <span class="kw">perplexity</span> <span class="kw">=</span> <span class="fl">30</span>)
<span class="no">sce</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span>(<span class="no">sce</span>, <span class="kw">dimred</span> <span class="kw">=</span> <span class="st">"PCA"</span>)
<span class="no">sce</span>
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2643 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(2): counts logcounts</span>
<span class="co">#&gt; rownames(32738): MIR1302-10 FAM138A ... AC002321.2 AC002321.1</span>
<span class="co">#&gt; rowData names(7): ENSEMBL_ID Symbol_TENx ... n_cells log10_total</span>
<span class="co">#&gt; colnames(2643): Cell1 Cell2 ... Cell2699 Cell2700</span>
<span class="co">#&gt; colData names(19): Sample Barcode ... log10_total sizeFactor</span>
<span class="co">#&gt; reducedDimNames(3): PCA TSNE UMAP</span>
<span class="co">#&gt; altExpNames(0):</span></pre></body></html></div>
<p>Finally, we cluster the cells using a graph-based algorithm, and find ‘marker genes’ for each cluster as the genes that are significantly upregulated in the cluster compared to each of the other inferred clusters. The adjusted p-values from this test, for each cluster, are added to the <code>rowData</code> slot of the object.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">snn.gr</span> <span class="kw">&lt;-</span> <span class="kw pkg">scran</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scran/man/buildSNNGraph.html">buildSNNGraph</a></span>(<span class="no">sce</span>, <span class="kw">use.dimred</span> <span class="kw">=</span> <span class="st">"PCA"</span>)
<span class="no">clusters</span> <span class="kw">&lt;-</span> <span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_walktrap.html">cluster_walktrap</a></span>(<span class="no">snn.gr</span>)
<span class="no">sce</span>$<span class="no">Cluster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">clusters</span>$<span class="no">membership</span>)
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sce</span>$<span class="no">Cluster</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14 </span>
<span class="co">#&gt; 420 354 143 212 161 318 324 189 150 144 117  75  25  11</span>

<span class="no">markers</span> <span class="kw">&lt;-</span> <span class="kw pkg">scran</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scran/man/findMarkers.html">findMarkers</a></span>(<span class="no">sce</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">sce</span>$<span class="no">Cluster</span>,
                              <span class="kw">test.type</span> <span class="kw">=</span> <span class="st">"t"</span>,
                              <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"up"</span>, <span class="kw">pval.type</span> <span class="kw">=</span> <span class="st">"all"</span>)
<span class="co">#&gt; Warning: 'rowGrid' is deprecated.</span>
<span class="co">#&gt; Use 'rowAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="co">#&gt; Warning: 'colGrid' is deprecated.</span>
<span class="co">#&gt; Use 'colAutoGrid' instead.</span>
<span class="co">#&gt; See help("Deprecated")</span>
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">markers</span>)) {
    <span class="fu">rowData</span>(<span class="no">sce</span>)[, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"FDR_cluster"</span>, <span class="no">i</span>)] <span class="kw">&lt;-</span>
        <span class="no">markers</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">FDR</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>),
                               <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">markers</span><span class="kw">[[</span><span class="no">i</span>]]))]
}
<span class="no">sce</span>
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2643 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(2): counts logcounts</span>
<span class="co">#&gt; rownames(32738): MIR1302-10 FAM138A ... AC002321.2 AC002321.1</span>
<span class="co">#&gt; rowData names(21): ENSEMBL_ID Symbol_TENx ... FDR_cluster13</span>
<span class="co">#&gt;   FDR_cluster14</span>
<span class="co">#&gt; colnames(2643): Cell1 Cell2 ... Cell2699 Cell2700</span>
<span class="co">#&gt; colData names(20): Sample Barcode ... sizeFactor Cluster</span>
<span class="co">#&gt; reducedDimNames(3): PCA TSNE UMAP</span>
<span class="co">#&gt; altExpNames(0):</span></pre></body></html></div>
<p>This concludes the preparation of the data. We have now a <code>SingleCellExperiment</code> object that contains different types of abundance values, representations in reduced dimensions, as well as a range of row (feature) and column (cell) metadata.</p>
<p>We can launch an <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> instance for exploring this data set using the <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code> function:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">iSEE</span>)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>)</pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-initial.png" width="992"></p>
<p>The main argument to the <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code> function is a <code>SummarizedExperiment</code> object, or an object of any class extending <code>SummarizedExperiment</code> (such as <code>SingleCellExperiment</code>, in this case). No other restrictions are made on the type of data stored in the object, and <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> can be used for interactive visualization of many different types of data. It is also worth noting that for various types of data, Bioconductor packages provides functionality for directly importing quantifications generated by external software packages into a <code>SummarizedExperiment</code> object. For example, the <em><a href="https://bioconductor.org/packages/3.12/DropletUtils">DropletUtils</a></em> package can read quantifications from the 10x Genomics CellRanger pipeline for single-cell RNA-seq data, and the <em><a href="https://bioconductor.org/packages/3.12/tximeta">tximeta</a></em> package can be used to read data from transcript quantification pipelines into a <code>SummarizedExperiment</code> object.</p>
<p>While we will not make explicit use of it in this workshop, we note that it is also possible to call <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code> without providing a <code>SummarizedExperiment</code> object. In that case, the user will be prompted to upload such an object, serialized into a <code>.rds</code> file. It is also possible to import a specification of the initial panel setup.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>()</pre></body></html></div>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-no-se.png" width="992"></p>
</div>
<div id="isee-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#isee-overview" class="anchor"></a>Overview of the <em>iSEE</em> package</h1>
<p>This section provides an overview of the graphical interface of <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> applications. To follow along, make sure that you have launched an <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> instance as described in the code block at the end of the previous section. Note that in the default configuration, the panels do not look exactly like the ones shown in the screenshots below. For example, data points are not immediately colored, and the default annotation variables displayed by each panel may differ. Later sections of this workshop demonstrate how to modify the content of the panels and how they are displayed.</p>
<p>Note that for simplicity, we typically refer to a <code>SummarizedExperiment</code> in this workshop; however, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> works seamlessly for objects of any class extending <code>SummarizedExperiment</code> as well (e.g., <code>SingleCellExperiment</code>, <code>DESeqDataSet</code>). That said, some types of panels – such as the <code>Reduced dimension plot</code> – are only available for objects that contain a <code>reducedDim</code> slot (in particular, <code>SingleCellExperiment</code> objects); the basic <code>SummarizedExperiment</code> class does not contain this slot. In this workshop, we refer to the rows of the <code>SummarizedExperiment</code> object as ‘features’ (these can be genes, transcripts, genomic regions, etc) and to the columns as ‘samples’ (which, in our example data set, are single cells).</p>
<div id="user-interface" class="section level2">
<h2 class="hasAnchor">
<a href="#user-interface" class="anchor"></a>The built-in panel types</h2>
<p>The <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> user interface consists of a number of panels, each displaying the data provided in the <code>SummarizedExperiment</code> from a specific perspective. There are 8 standard panel types; 6 plot panels and 2 table panels, all showcased in the figure shown at the end of section <a href="#prepare-scrnaseq-data">Preparation of example scRNAseq data</a>. In the default configuration, one panel of each type is included when launching the <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> user interface. However, users are free to rearrange, resize, remove or add panels freely, as described in the later section <a href="#configuration-ui">Configuration of the app interface</a>. We provide a brief overview of each panel type in the following subsections.</p>
<p>In addition to the 8 standard panel types included in <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em>, users can create custom panels (both plots and tables). Moreover, the <em><a href="https://bioconductor.org/packages/3.12/iSEEu">iSEEu</a></em> (iSEE universe) package contains additional panel types. The creation and configuration of custom panels is discussed later, in the dedicated section <a href="#custom-panels">Custom panels</a>.</p>
<!-- This is perhaps not very pedagogical - the app will not look like the one below if it is just opened with the object created above.
But it's nice to show the capabilities of the panels too, not just the default settings.
I added a few sentences to the introduction of this section to try to address this. -->
<!-- ![](img/iSEEinterface.png) -->
<div id="reddimplot" class="section level3">
<h3 class="hasAnchor">
<a href="#reddimplot" class="anchor"></a>Reduced dimension plot</h3>
<p>The reduced dimension plot can display any reduced dimension representation that is present in the <code>reducedDim</code> slot of the <code>SingleCellExperiment</code> object.</p>
<p>Note that this slot is not defined for the base <code>SummarizedExperiment</code> class, in which case the user interface does not allow the inclusion of panels of this type.</p>
<p><img src="screenshots/isee-reduceddimensionplot.png" width="992"></p>
<!-- ![](img/redDimPlot.png) -->
</div>
<div id="coldataplot" class="section level3">
<h3 class="hasAnchor">
<a href="#coldataplot" class="anchor"></a>Column data plot</h3>
<p>The column data plot can display one or two of the provided column annotations (from the <code>colData</code> slot). Depending on the class of the selected annotations, the panel shows either a scatter plot, a violin plot, or a Hinton diagram <span class="citation">(Hinton and Shallice 1991; Bremner, Gotts, and Denham 1994)</span>.</p>
<p><img src="screenshots/isee-columndataplot.png" width="992"></p>
<!-- ![](img/colDataPlot.png) -->
</div>
<div id="rowdataplot" class="section level3">
<h3 class="hasAnchor">
<a href="#rowdataplot" class="anchor"></a>Row data plot</h3>
<p>Analogous to the <a href="#coldataplot">column data plot</a> above, the row data plot displays one or two of the provided row annotations (from the <code>rowData</code> slot). Depending on the class of the selected annotations, the panel displays either a scatter plot, a violin plot, or a Hinton plot.</p>
<p><img src="screenshots/isee-rowdataplot.png" width="992"></p>
<!-- ![](img/rowDataPlot.png) -->
</div>
<div id="heatmap" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap" class="anchor"></a>Complex heatmap</h3>
<p>The complex heatmap panel displays, for any assay, the observed values for a subset of the features across the samples.</p>
<p><img src="screenshots/isee-complexheatmapplot.png" width="992"></p>
<!-- ![](img/heatMap.png) -->
</div>
<div id="featassayplot" class="section level3">
<h3 class="hasAnchor">
<a href="#featassayplot" class="anchor"></a>Feature assay plot</h3>
<p>The feature assay plot displays the observed values for one feature across the samples. It is also possible to plot the observed values for two features, in a scatter plot.</p>
<p><img src="screenshots/isee-featureassayplot.png" width="992"></p>
<!-- ![](img/featAssayPlot.png) -->
</div>
<div id="sampassayplot" class="section level3">
<h3 class="hasAnchor">
<a href="#sampassayplot" class="anchor"></a>Sample assay plot</h3>
<p>Analogous to the <a href="#featassayplot">feature assay plot</a> above, the sample assay plot shows the observed values for all features, for one of the samples. It is also possible to plot the observed values for two samples, in a scatter plot.</p>
<p><img src="screenshots/isee-sampleassayplot.png" width="992"></p>
<!-- ![](img/sampAssayPlot.png) -->
</div>
<div id="rowdatatable" class="section level3">
<h3 class="hasAnchor">
<a href="#rowdatatable" class="anchor"></a>Row data table</h3>
<p>The row data table displays all information provided in the <code>rowData</code> slot of the <code>SummarizedExperiment</code> object, leveraging the interactivity provided by the <em><a href="https://CRAN.R-project.org/package=DT">DT</a></em> package.</p>
<p><img src="screenshots/isee-rowdatatable.png" width="992"></p>
<!-- ![](img/rowStatTable.png) -->
</div>
<div id="coldatatable" class="section level3">
<h3 class="hasAnchor">
<a href="#coldatatable" class="anchor"></a>Column data table</h3>
<p>Analogous to the <a href="#rowdatatable">row data table</a> above, the column data table displays all information provided in the <code>colData</code> slot of the <code>SummarizedExperiment</code> object.</p>
<p><img src="screenshots/isee-columndatatable.png" width="992"></p>
<!-- ![](img/colStatTable.png) -->
</div>
</div>
<div id="collapsible-boxes" class="section level2">
<h2 class="hasAnchor">
<a href="#collapsible-boxes" class="anchor"></a>Collapsible boxes with display controls</h2>
<div id="data-parameters-box" class="section level3">
<h3 class="hasAnchor">
<a href="#data-parameters-box" class="anchor"></a>‘Data parameters’ collapsible box</h3>
<p>Each plot panel type has a <code>Data parameters</code> collapsible box. This box has different content for each panel type, but in all cases it lets the user control the data that is displayed in the plot.</p>
<p><img src="screenshots/isee-columndataplot-dataparameters.png" width="992"></p>
<!-- ![](img/colDataPlotDataParams.png) -->
</div>
<div id="visual-parameters-box" class="section level3">
<h3 class="hasAnchor">
<a href="#visual-parameters-box" class="anchor"></a>‘Visual parameters’ collapsible box</h3>
<p>In contrast to the <code>Data parameters</code> collapsible box that lets users control <em>what</em> is displayed in the plot, the <code>Visual parameters</code> box lets users control <em>how</em> the information is displayed.</p>
<p>This collapsible box contains the controls to change the size, shape, opacity, and color of the points, to facet the plot by any available categorical annotation, to subsample points for increased speed of plot rendering, and to control how legends are displayed.</p>
<p><img src="screenshots/isee-columndataplot-visualparameters.png" width="992"></p>
<!-- ![](img/colDataPlotVisualParams.png) -->
</div>
<div id="selection-parameter-box" class="section level3">
<h3 class="hasAnchor">
<a href="#selection-parameter-box" class="anchor"></a>‘Selection parameters’ collapsible box</h3>
<p>The <code>Selection parameters</code> collapsible box provides controls to transfer selections of points (features or samples) between panels.</p>
<p>We discuss point transmission in more detail <a href="#transmit-point-selections">later in this workshop</a>.</p>
<p><img src="screenshots/isee-reduceddimensionplot-selectionparameters.png" width="992"></p>
<!-- ![](img/redDimPlotSelectionParams.png) -->
</div>
</div>
<div id="additional-controls" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-controls" class="anchor"></a>Additional controls</h2>
<p>At the top-right corner of the iSEE application, users can find additional controls for reproducibility, configuration, and help. Each of these is discussed in more detail later in this workshop. Links are provided in the last column of the table below.</p>
<!-- |                    |                                                                     |                                        |
|--------------------|:-------------------------------------------------------------------:|----------------------------------------|
| Panel organization | <img width="175" src="img/PanelOrganization.png"/> | [Organize panels](#configuration-ui) |
| Diagnostics        | <img width="175" src="img/Diagnostics.png"/>       | [Examine panel chart](#transmit-point-selections), [Extract R code](#reproducibility), [Display panel settings](#configuration-ui) |
| Documentation      | <img width="175" src="img/Documentation.png"/>     | [Quick tour](#sharing-tours), [Open the vignette](#more-resources) |
| Additional info    | <img width="175" src="img/AdditionalInfo.png"/>    | [About this session](#reproducibility), [About iSEE](#more-resources) | -->
<table class="table"><tbody>
<tr class="odd">
<td>Organization</td>
<td align="center"><img src="controls/PanelOrganization.png" width="433"></td>
<td>
<a href="#configuration-ui">Organize panels</a> <br><a href="#transmit-point-selections">Examine panel chart</a>
</td>
</tr>
<tr class="even">
<td>Export</td>
<td align="center"><img src="controls/Export.png" width="386"></td>
<td>
<a href="#download-output">Download panel output</a> <br><a href="#reproducibility">Extract R code</a> <br><a href="#configuration-ui">Display panel settings</a>
</td>
</tr>
<tr class="odd">
<td>Documentation</td>
<td align="center"><img src="controls/Documentation.png" width="337"></td>
<td>
<a href="#sharing-tours">Quick tour</a> <br><a href="#more-resources">Open the vignette</a>
</td>
</tr>
<tr class="even">
<td>Additional info</td>
<td align="center"><img src="controls/AdditionalInfo.png" width="298"></td>
<td>
<a href="#reproducibility">About this session</a> <br><a href="#more-resources">About iSEE</a>
</td>
</tr>
</tbody></table>
<!-- Show how to change what is plotted, faceting, changing appearance/color --><!-- Transmit selections --><!-- Subsampling -->
</div>
<div id="configuration-ui" class="section level2">
<h2 class="hasAnchor">
<a href="#configuration-ui" class="anchor"></a>Configuration of the app interface</h2>
<p>As mentioned above, the default behaviour of the <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code> function is to launch an instance of the user interface that displays one panel of each of the standard types (provided the underlying data is available, e.g. for reduced dimension plots the <code>reducedDim</code> slot is required). However, in some cases it is desirable to have multiple panels of the same type, and/or exclude some panel types.</p>
<p>In order to accommodate such situations, users can add, remove, change the order of and resize all panels via the <code>Organization</code> menu in the top-right corner.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Using your open <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> instance, open the <code>Organization</code> menu (<i class="fa fa-object-group"></i>) and click on the <code>Organize panels</code> (<i class="fa fa-object-ungroup"></i>) button. Try to add and remove panels, and resize the existing ones. Remember to click on <code>Apply settings</code> (<i class="fa fa-object-ungroup"></i>) to apply the changes you have made to the interface.</p>
</blockquote>
<p>Clicking in the selectize box listing all current panels will present you with a drop-down menu from which you can choose additional panels to add. Similarly, panels can be removed by clicking on the <i class="fa fa-times"></i> icon associated with the panel name.</p>
<p>Each panel can be individually resized by changing the width and height. Note that the total width of a row in the interface is 12 units. When the width of a panel is greater than the space available, the panel is moved to a new row.</p>
<p>It can take a great amount of time to achieve a satisfactory panel configuration. To avoid the need to manually organize the panels each time the app is opened, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> offers the possibility to specify how the app is initialized, as well as to inspect and export the current panel settings for future use.</p>
<p>As a first example, let’s assume that we would like to start <code>iSEE</code> with the default set of eight panels, but we want each panel to have width equal to 3 units rather than the default 4, so that we can fit all the panels in two rows. To achieve this, we define a list that we name <code>initial</code>, which contains the specifications for all the panels that should be included at startup.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/RowDataPlot-class.html">RowDataPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ComplexHeatmapPlot-class.html">ComplexHeatmapPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/SampleAssayPlot-class.html">SampleAssayPlot</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/RowDataTable-class.html">RowDataTable</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataTable-class.html">ColumnDataTable</a></span>(<span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">3L</span>)
)</pre></body></html></div>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the application, run the code above in your <em>R</em> session, and relaunch the application, now with the additional argument <code>initial</code> set:</p>
</blockquote>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-initial-2rows.png" width="992"></p>
<p>Notice how the panel configuration at startup is now different from the default one. The setup is fully customizable - it is possible to include multiple panels of each types, and the size specifications of a given panel are independent of those for the other panels. It is even possible to start an app without any panels at all, by simply providing an empty list to <code>initial</code> (see also <code><a href="https://rdrr.io/pkg/iSEEu/man/modeEmpty.html">iSEEu::modeEmpty()</a></code>). Regardless of the initialization choice, once the app is launched, the user by default retains full flexibility to reorganize the interface interactively (it is possible to limit the types of panels that can be added via the <code>extra</code> argument to <code>iSEE</code>).</p>
<p>Now that we have an application consisting of a suitable collection of panels for our data set, we’ll explore the collapsible boxes below each plot, which lets us control their appearance.</p>
<div id="choose-reduced-dimension" class="section level3">
<h3 class="hasAnchor">
<a href="#choose-reduced-dimension" class="anchor"></a>Displaying a different reduced dimension representation</h3>
<p>By default, each <em>Reduced dimension plot</em> displays the first reduced dimension representation provided (contained in the <code>reducedDim</code> slot of the <code>SingleCellExperiment</code> object). If additional reduced dimension representations are included, the one chosen for the display can be changed in the <code>Data parameters</code> collapsible box in the <em>Reduced dimension plot</em> panel.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Use this control to show the t-SNE representation instead of the PCA.</p>
</blockquote>
<p>Notably, the instance can be preconfigured to immediately display the t-SNE representation when the application is launched.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the application and run the following block of code to show two <em>Reduced dimension plot</em> panels; one showing the PCA representation, one showing the t-SNE representation.</p>
</blockquote>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"PCA"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>)
)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-reduceddimensiontype.png" width="992"></p>
<!-- ![](img/ReducedDimensionType.png) -->
</div>
<div id="color-by-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#color-by-annotation" class="anchor"></a>Coloring points by row/column annotation</h3>
<p>With default settings, all points are colored black. However, any provided row (for features) or column (for samples) annotation can be used to color the points.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> To demonstrate this, open the <code>Visual parameters</code> collapsible box in one of the <em>Reduced dimension plot</em> panels, and set <code>Color by:</code> to <code>Column data</code>. Scroll through the dropdown menu that appears in order to see all the sample annotations that can be used to color the points. All these values are taken from the <code>colData</code> slot of the provided object.</p>
</blockquote>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> First, color the cells by <code>Cluster</code>, which contains the cluster labels that were assigned to the cells in the preprocessing step <a href="#prepare-scrnaseq-data">in a previous section</a>. Note how a discrete color scheme is selected, since the variable is categorical.</p>
</blockquote>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Next, color the cells by the log10-transformed number of detected genes (<code>log10_total</code>). Notice how the color scale is now continuous.</p>
</blockquote>
<p>The instance can be preconfigured to control the coloring of data points, to display the same result on startup.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the application and run the following block of code to edit the configuration of the two <em>Reduced dimension plot</em> panels prepared in the <a href="#choose-reduced-dimension">previous section</a>.</p>
</blockquote>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"PCA"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"log10_total"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>)
)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-colorbycoldata.png" width="992"></p>
<!-- ![](img/ColorByColData.png) -->
<p><em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> allows precise control over the color schemes used. More information about this can be found in the <a href="https://bioconductor.org/packages/3.12/iSEE/vignettes/ecm.html">ExperimentColorMap</a> vignette.</p>
</div>
<div id="color-by-feature" class="section level3">
<h3 class="hasAnchor">
<a href="#color-by-feature" class="anchor"></a>Coloring points by feature value</h3>
<p>In addition to coloring cells by the provided annotations as above, we can also color them by the observed values for a given feature (as provided in one of the <code>assays</code>).</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Set <code>Color by:</code> to <code>Feature name</code> in one of the <em>Reduced dimension plot</em> panels, and select one of the genes from the dropdown menu. You can search for a gene of interest by typing in the dropdown box. You can also choose which assay should be used to extract the values to color according to.</p>
</blockquote>
<p>Again, the same result can be achieved by preconfiguring the application as follows.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the application and run the following block of code to set up 3 panels, all displaying the t-SNE representation. In the first panel, we color cells by their <code>Cluster</code> label. In the second and third panel, we display <em>CD79A</em> and <em>CD74</em>, a combination of gene markers typically observed in B cells.</p>
</blockquote>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co">## The displayed features IDs must be row names of the object</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD79A"</span>, <span class="st">"CD74"</span>) <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sce</span>)
<span class="co">#&gt; [1] TRUE TRUE</span>
<span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Feature name"</span>,
                       <span class="kw">ColorByFeatureName</span> <span class="kw">=</span> <span class="st">"CD79A"</span>,
                       <span class="kw">ColorByFeatureNameAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Feature name"</span>,
                       <span class="kw">ColorByFeatureName</span> <span class="kw">=</span> <span class="st">"CD74"</span>,
                       <span class="kw">ColorByFeatureNameAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-colorbyfeature.png" width="992"></p>
<!-- ![](img/ColorByFeature.png) -->
<!-- > <i class="fa fa-wrench fa-2x"></i> **Action:** click on the export icon (<i class="fa fa-download fa-1g"></i>) in the top-right corner, and select 'Display panel settings'.
This opens a pop-up window with the code required to generate all the currently visible panels. -->
</div>
<div id="highlight" class="section level3">
<h3 class="hasAnchor">
<a href="#highlight" class="anchor"></a>Highlighting a single point</h3>
<p>The <code>Color by: Sample name</code> option in the <em>Reduced dimension plot</em> can also be used to highlight a single sample.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Set <code>Color by:</code> to <code>Sample name</code> in one of the Reduced dimension plots, and use the dropdown menu underneath to change the highlighted cell.</p>
</blockquote>
<p>Again, the same result can be achieved by preconfiguring the application.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to continue editing the configuration of the <em>Reduced dimension plot</em> panels prepared in the <a href="#color-by-feature">previous section</a>. We also open the <em>Visual parameters</em> collapsible box to highlight the preconfigured options.</p>
</blockquote>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Sample name"</span>,
                       <span class="kw">ColorBySampleName</span> <span class="kw">=</span> <span class="st">"Cell2439"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Sample name"</span>,
                       <span class="kw">ColorBySampleName</span> <span class="kw">=</span> <span class="st">"Cell673"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-colorbysample.png" width="992"></p>
<!-- ![](img/ColorBySample.png) -->
</div>
<div id="change-shape-opacity" class="section level3">
<h3 class="hasAnchor">
<a href="#change-shape-opacity" class="anchor"></a>Changing the size, shape and opacity of points</h3>
<p>By default, only the <code>Color</code> options are displayed in the <code>Visual parameters</code> box. Additional controls can be shown by clicking the check boxes for <code>Shape</code>, <code>Size</code>, <code>Point</code>, <code>Facet</code> and <code>Text</code>. The <code>Size</code>, <code>Shape</code> and <code>Point</code> panels let you set the shape and size of points according to provided annotations (or to resize all points), and to set the point opacity. Here, you can also downsample points to increase the speed of rendering, which can be useful for data sets with large numbers of points.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to continue editing the configuration of the <em>Reduced dimension plot</em> panels prepared in the <a href="#color-by-feature">previous section</a>. Here, we reduce the point size and increase the transparency (i.e. reduce the value for the alpha attribute). We also apply a downsampling grid of 100 horizontal and vertical bins to the plot, where only a single data point is plotted (if any) for each bin. Finally, we display the <code>Shape</code> and <code>Point</code> options.</p>
</blockquote>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">Downsample</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">DownsampleResolution</span> <span class="kw">=</span> <span class="fl">100</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Sample name"</span>,
                       <span class="kw">ColorBySampleName</span> <span class="kw">=</span> <span class="st">"Cell2439"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">PointSize</span> <span class="kw">=</span> <span class="fl">0.4</span>,
                       <span class="kw">PointAlpha</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">Downsample</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">DownsampleResolution</span> <span class="kw">=</span> <span class="fl">100</span>,
                       <span class="kw">VisualChoices</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Shape"</span>, <span class="st">"Point"</span>)),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Sample name"</span>,
                       <span class="kw">ColorBySampleName</span> <span class="kw">=</span> <span class="st">"Cell673"</span>,
                       <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">PointSize</span> <span class="kw">=</span> <span class="fl">0.4</span>,
                       <span class="kw">PointAlpha</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">Downsample</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">DownsampleResolution</span> <span class="kw">=</span> <span class="fl">100</span>,
                       <span class="kw">VisualChoices</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Shape"</span>, <span class="st">"Point"</span>))
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-configurevisualparameters.png" width="992"></p>
<!-- ![](img/ConfigureVisualParameters.png) -->
</div>
<div id="change-metadata-displayed" class="section level3">
<h3 class="hasAnchor">
<a href="#change-metadata-displayed" class="anchor"></a>Changing the displayed metadata</h3>
<p>The <em>Column data plot</em> and <em>Row data plot</em> panels are used to display the information in the <code>colData</code> and <code>rowData</code> slots of the <code>SummarizedExperiment</code> object. These panels can display either one or two annotations. By default, the first annotation in the respective metadata table is selected.</p>
<p>The plot layout adapts automatically to the type of annotation(s) displayed.</p>
<ul>
<li>When all chosen annotations are categorical, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> displays a Hinton plot, consisting of rectangles with an area proportional to the number of observations they represent.</li>
<li>For a single continuous variable, or one continuous and one categorical variable, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> uses violin plot(s).</li>
<li>If two continuous variables are chosen, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> displays a scatter plot.</li>
</ul>
<p>As a side note, categorical variables with “too many” unique values (which is typically the case for sample IDs, for instance) are represented as numeric variables, by replacing each value by an index. The limit for what is considered “too many” unique values can be set using <code><a href="https://rdrr.io/r/base/options.html">options(iSEE.maxlevels = 30)</a></code>.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Start an instance with the default set of panels and explore the different types of plots provided in the Column data or Row data plot panels by selecting different annotations as the <code>Column of interest (Y-axis)</code> and/or setting <code>X-axis:</code> to <code>Column data</code> and selecting an additional annotation.</p>
</blockquote>
<p>In the following code chunk we demonstrate the preconfiguration of an app instance that immediately displays two panels.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to set up one <em>Column data plot</em> and one <em>Row data plot</em> panel. We set up the <em>Column data plot</em> panel to immediately examine the proportion of counts assigned to mitochondrial features in each cluster. We set up the <em>Row data plot</em> panel to examine the proportion of cells with detectable expression against the log-transformed total counts for each gene.</p>
</blockquote>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span>(<span class="kw">YAxis</span> <span class="kw">=</span> <span class="st">"subsets_MT_percent"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                 <span class="kw">XAxisColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/RowDataPlot-class.html">RowDataPlot</a></span>(<span class="kw">YAxis</span> <span class="kw">=</span> <span class="st">"n_cells"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Row data"</span>,
              <span class="kw">XAxisRowData</span> <span class="kw">=</span> <span class="st">"log10_total"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">6L</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-configuredataplotpanels.png" width="992"></p>
<!-- ![](img/ConfigureDataPlotPanels.png) -->
</div>
<div id="display-gene-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#display-gene-expression" class="anchor"></a>Displaying gene expression</h3>
<p>The <em>Feature assay plot</em> is used to display the observed values for one feature across the samples on the Y-axis. By default, the first feature in the <code>rownames</code> of the dataset is selected, displaying its distribution across the entire dataset.</p>
<p>While continuous measurements are more common (e.g., gene expression), discrete assays are also supported (e.g., single nucleotide polymorphisms), and displayed as a Hinton plot, consisting of rectangles with an area proportional to the number of samples they represent.</p>
<p>It is also possible to plot the observed values of a second feature on the X-axis. This will result in a scatter plot or Hinton plot, depending on the continuous or discrete nature of the data, respectively.</p>
<p>Alternatively, the X-axis can also be used to stratify gene expression according to a discrete sample metadata in the form of a violin plot, while a continuous metadata will generate a scatter plot.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Start an instance with the default set of panels and explore the different types of plots generated by the Feature assay plot panel using the choices available for the two axes.</p>
</blockquote>
<p>Similarly to all other panels, the <em>Feature assay plot</em> can be preconfigured to immediately display specific information when the app is launched.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to set up three <em>Feature assay plot</em> panels demonstrating different configurations. All three panels display the same gene on the Y-axis and color data points according to their cluster label. On the X-axis, the first panel displays a discrete sample metadata variable, the cluster label; the second panel display a continuous sample metadata variable, the log-transformed library size; the third panel displays the expression of a second gene.</p>
</blockquote>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span>(<span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>, <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
                   <span class="kw">YAxisFeatureName</span> <span class="kw">=</span> <span class="st">"CD3D"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                   <span class="kw">XAxisColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">DataBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                   <span class="kw">Assay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span>(<span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>, <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
                   <span class="kw">YAxisFeatureName</span> <span class="kw">=</span> <span class="st">"CD3D"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                   <span class="kw">XAxisColumnData</span> <span class="kw">=</span> <span class="st">"log10_total"</span>, <span class="kw">DataBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                   <span class="kw">Assay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span>(<span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>, <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
                   <span class="kw">YAxisFeatureName</span> <span class="kw">=</span> <span class="st">"CD3D"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Feature name"</span>,
                   <span class="kw">XAxisFeatureName</span> <span class="kw">=</span> <span class="st">"CD40LG"</span>, <span class="kw">DataBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                   <span class="kw">Assay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-featassayplotdataparams.png" width="992"></p>
<!-- ![](img/featAssayPlotDataParams.png) -->
</div>
<div id="transmit-point-selections" class="section level3">
<h3 class="hasAnchor">
<a href="#transmit-point-selections" class="anchor"></a>Linking panels and transmitting point selections</h3>
<p>When exploring data, it is often useful to be able to select a subset of points and investigate different aspects of their characteristic features. In <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em>, this can be achieved by <em>selecting</em> points in one panel, and <em>transmitting</em> this selection to one or more other panels.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Select a set of points in one of the <em>Feature assay plot</em> panels, by drawing a rectangle around them. Then open the <em>Selection parameters</em> collapsible box of one of the other <em>Feature assay plot</em> panels, and select the <em>Feature assay plot</em> panel where you made the point selection from the dropdown menu under <strong>Receive column selection from</strong>. Note how the points corresponding to the cells that you selected in the first panel are highlighted in the receiving panel. You can highlight the points in different ways by changing the <strong>Selection effect</strong>.</p>
</blockquote>
<p>Also the brushing and point selection can be preconfigured. In the example below, we configure three types of panels: a <em>Feature assay plot</em>, a <em>Reduced dimension plot</em>, and a <em>Column data plot</em>. For visual convenience, we color data points in all three panels by the cluster label.</p>
<p>To demonstrate the feature, we define a Shiny brush in the <em>Feature assay plot</em> panel to select cells with detectable levels of the <em>CD3D</em> gene. For the other two panels, pay particular attention to the <code>"ColumnSelectionSource"</code> instruction which declares that they should both receive the data points selected in the <em>Feature assay plot</em> panel. In addition, we specify that the <em>Reduced dimension plot</em> should highlight the selection by applying a transparency effect to <em>unselected</em> data points. Alternatively, we use the <em>Column data plot</em> to demonstrate how the selection can also be highlighted by applying a given color (here, red) to the selected data points.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to launch the example application described above.</p>
</blockquote>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span>(<span class="kw">YAxisFeatureName</span> <span class="kw">=</span> <span class="st">"CD3D"</span>, <span class="kw">BrushData</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">xmin</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">14.5</span>, <span class="kw">ymin</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">5.7</span>,
    <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"X"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Y"</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="st">"GroupBy"</span>),
    <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"xy"</span>,
    <span class="kw">brushId</span> <span class="kw">=</span> <span class="st">"featAssayPlot1_Brush"</span>, <span class="kw">outputId</span> <span class="kw">=</span> <span class="st">"featAssayPlot1"</span>),
    <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Column data"</span>, <span class="kw">XAxisColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
    <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>, <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">ColumnSelectionSource</span> <span class="kw">=</span> <span class="st">"FeatureAssayPlot1"</span>,
                       <span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">SelectionBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span>(<span class="kw">ColumnSelectionSource</span> <span class="kw">=</span> <span class="st">"FeatureAssayPlot1"</span>, <span class="kw">SelectionEffect</span> <span class="kw">=</span> <span class="st">"Color"</span>,
                 <span class="kw">YAxis</span> <span class="kw">=</span> <span class="st">"log10_total"</span>, <span class="kw">XAxis</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                 <span class="kw">XAxisColumnData</span> <span class="kw">=</span> <span class="st">"subsets_MT_percent"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                 <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">SelectionBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-linkingpanelsexample.png" width="992"></p>
<p>Notably, iSEE can display active links transmitting point selections between panel using the “<a href="#additional-controls">Examine panel chart</a>” menu.</p>
<!-- ![](img/GraphSelectionLinks.png) -->
</div>
<div id="zoom-subregion" class="section level3">
<h3 class="hasAnchor">
<a href="#zoom-subregion" class="anchor"></a>Zooming into a plot subregion</h3>
<p>iSEE allows you to zoom into a subregion of a plot, by simply drawing a rectangle around the area of interest and double-clicking inside the rectangle. To zoom back out to the full plot, double-click anywhere in the plot.</p>
<p>To demonstrate the feature, we set up two <em>Reduced dimension plot</em> panels. In the first panel, we draw a Shiny brush to indicate an area of interest in the reduced dimension plot. We preconfigure the second panel to display only that area. In both panels, we color data points by cluster label using the same color map, to help visualize the zoom relationship between the two panels.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to launch the example application described above. Double-click on the area selected in the first panel to zoom and display the same view as the second panel. Double click again anywhere in the panel to zoom out.</p>
</blockquote>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">PointSize</span> <span class="kw">=</span> <span class="fl">1</span>,
                       <span class="kw">BrushData</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">xmin</span> <span class="kw">=</span> <span class="fl">3.4</span>, <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">27.3</span>, <span class="kw">ymin</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">30.0</span>,
    <span class="kw">log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="kw">NULL</span>), <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"X"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Y"</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"ColorBy"</span>),
    <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"xy"</span>, <span class="kw">brushId</span> <span class="kw">=</span> <span class="st">"redDimPlot1_Brush"</span>, <span class="kw">outputId</span> <span class="kw">=</span> <span class="st">"redDimPlot1"</span>)),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>, <span class="kw">PointSize</span> <span class="kw">=</span> <span class="fl">2</span>,
                       <span class="kw">ZoomData</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">xmin</span> <span class="kw">=</span> <span class="fl">3.4</span>, <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">27.3</span>, <span class="kw">ymin</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">30.0</span>))
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-zoom.png" width="992"></p>
<!-- ![](img/Zoom.png) -->
</div>
<div id="filter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-table" class="anchor"></a>Filtering tables</h3>
<p>Tables may also be preconfigured to immediately display a subset of rows according to their filters or select a row different from the first one when the app is launched.</p>
<p>For simplicity, we demonstrate this feature using a subset of 3 column metadata–namely “Cluster”, “total”, and “subsets_MT_percent”–out of the set of 20 column metadata computed by the <a href="#prepare-scrnaseq-data">workflow above</a>.</p>
<p>In the example below, we preconfigure a <em>Column statistics table</em> to display only cells with cluster labels “3” and “5”, and a library size between 5,000 and 15,844 (the maximum library size in the dataset). In addition, we also preselect the cell named “Cell943”.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to launch the example application described above.</p>
</blockquote>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">sce1</span> <span class="kw">&lt;-</span> <span class="no">sce</span>
<span class="fu">colData</span>(<span class="no">sce1</span>) <span class="kw">&lt;-</span> <span class="fu">colData</span>(<span class="no">sce1</span>)[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Cluster"</span>, <span class="st">"total"</span>, <span class="st">"subsets_MT_percent"</span>)]
<span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataTable-class.html">ColumnDataTable</a></span>(<span class="kw">SearchColumns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"[\"3\", \"5\"]"</span>, <span class="st">"5000 ... 15844"</span>, <span class="st">""</span>),
                  <span class="kw">Selected</span> <span class="kw">=</span> <span class="st">"Cell943"</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">12L</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce1</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-filteredtable.png" width="992"></p>
<!-- ![](img/FilteredTable.png) -->
<p>Notably the preselected cell can be used to immediately establish a relationship with another panel and highlighted the selection in a different panel <a href="#transmit-point-selections">as demonstrated earlier</a>.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the app and run the following block of code to launch an application that includes a <em>Reduced dimension plot</em> panel dynamically higlighting the cell selected in the <em>Column statistics table</em>. Select different rows of the cell to see the <em>Reduced dimension plot</em> panel update accordingly.</p>
</blockquote>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataTable-class.html">ColumnDataTable</a></span>(<span class="kw">SearchColumns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"[\"3\", \"5\"]"</span>, <span class="st">"5000 ... 15844"</span>, <span class="st">""</span>),
                  <span class="kw">Selected</span> <span class="kw">=</span> <span class="st">"Cell943"</span>, <span class="kw">PanelId</span> <span class="kw">=</span> <span class="fl">1L</span>, <span class="kw">PanelWidth</span> <span class="kw">=</span> <span class="fl">8L</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">VisualBoxOpen</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Sample name"</span>,
                       <span class="kw">ColorBySampleSource</span> <span class="kw">=</span> <span class="st">"ColumnDataTable1"</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce1</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-linktabletoplot.png" width="992"></p>
<!-- ![](img/LinkTableToPlot.png) -->
</div>
</div>
<div id="save-and-restore-user-interface" class="section level2">
<h2 class="hasAnchor">
<a href="#save-and-restore-user-interface" class="anchor"></a>Saving and restoring the state of the application</h2>
<p>In the previous sections we have seen how we can specify the initial state of each panel. Often, the initial exploration of a data set, including reorganization and configuration of panels, is done interactively. Once a satisfactory panel setup has been achieved, the corresponding settings can be exported and used to restore the state of the app at startup.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Click on the export icon (<i class="fa fa-download fa-1g"></i>) in the top-right corner, and select ‘Display panel settings’. Copy all the code shown in the pop-up window. Close the app and paste this code in your R session. This defines the ‘initial’ list that we have composed manually in the examples above. Then launch a new instance using the following code. Note how the app starts in the same configuration as it was before closing. Of course, it is still possible to continue exploring the data interactively - we have only changed the starting configuration.</p>
</blockquote>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce1</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
</div>
<div id="custom-panels" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-panels" class="anchor"></a>Custom panels</h2>
<p>In addition to the standard panel types, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> allows the user to create <em>custom</em> panels, displaying any type of plot or table. The custom panels can receive row and column selections from the standard panels. In order to create a custom panel, we need to define a function that generates the desired output. This function must receive a <code>SummarizedExperiment</code> object as it first input. In addition, it should take a list of character vectors containing row names as the second argument (can be <code>NULL</code> if no selection is made), and similarly a list of character vectors containing column names as the third argument.</p>
<div id="example-custom-reduced-dimension-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#example-custom-reduced-dimension-plot" class="anchor"></a>Example: Custom reduced dimension plot</h3>
<p>We will first show how to create a custom panel that performs dimension reduction on a subset of the rows and columns, selected in and transmitted from other panels in the interface.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Copy the code below in your R session in order to define the custom function.</p>
</blockquote>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scater</span>)
<span class="no">CUSTOM_DIMRED</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">se</span>, <span class="no">rows</span>, <span class="no">columns</span>, <span class="no">ntop</span><span class="kw">=</span><span class="fl">500</span>, <span class="no">scale</span><span class="kw">=</span><span class="fl">TRUE</span>,
    <span class="no">mode</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PCA"</span>, <span class="st">"TSNE"</span>, <span class="st">"UMAP"</span>)) {
    <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">columns</span>)) {
        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(
            <span class="fu">ggplot</span>() + <span class="fu">theme_void</span>() + <span class="fu">geom_text</span>(
                <span class="fu">aes</span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">label</span><span class="kw">=</span><span class="no">label</span>),
                <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">y</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">label</span><span class="kw">=</span><span class="st">"No column data selected."</span>),
                <span class="kw">size</span><span class="kw">=</span><span class="fl">5</span>)
            )
    }

    <span class="no">mode</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html">match.arg</a></span>(<span class="no">mode</span>)
    <span class="kw">if</span> (<span class="no">mode</span><span class="kw">==</span><span class="st">"PCA"</span>) {
        <span class="no">calcFUN</span> <span class="kw">&lt;-</span> <span class="no">runPCA</span>
    } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">mode</span><span class="kw">==</span><span class="st">"TSNE"</span>) {
        <span class="no">calcFUN</span> <span class="kw">&lt;-</span> <span class="no">runTSNE</span>
    } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">mode</span><span class="kw">==</span><span class="st">"UMAP"</span>) {
        <span class="no">calcFUN</span> <span class="kw">&lt;-</span> <span class="no">runUMAP</span>
    }

    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1000</span>)
    <span class="no">kept</span> <span class="kw">&lt;-</span> <span class="no">se</span>[, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">columns</span>))]
    <span class="no">kept</span> <span class="kw">&lt;-</span> <span class="fu">calcFUN</span>(<span class="no">kept</span>, <span class="kw">ncomponents</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ntop</span><span class="kw">=</span><span class="no">ntop</span>,
        <span class="kw">scale</span><span class="kw">=</span><span class="no">scale</span>, <span class="kw">subset_row</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">rows</span>)))
    <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html">plotReducedDim</a></span>(<span class="no">kept</span>, <span class="no">mode</span>)
}</pre></body></html></div>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Next, launch an iSEE session with the custom reduced dimension plot panel, as well as a <em>Row data plot</em> panel and a <em>Column data plot</em> panel, from which the row and column selections for the custom reduced dimension representation are obtained. Select subsets of the points in each of these two panels and note how the plot in the custom panel is updated.</p>
</blockquote>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">GENERATOR</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/createCustomPanels.html">createCustomPlot</a></span>(<span class="no">CUSTOM_DIMRED</span>)
<span class="no">custom_panel</span> <span class="kw">&lt;-</span> <span class="fu">GENERATOR</span>()

<span class="no">initial</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(
    <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
    <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>,
    <span class="kw">PanelId</span><span class="kw">=</span><span class="fl">1L</span>
  ),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/RowDataPlot-class.html">RowDataPlot</a></span>(
    <span class="kw">XAxis</span><span class="kw">=</span><span class="st">"Row data"</span>,
    <span class="kw">YAxis</span><span class="kw">=</span><span class="st">"detected"</span>,
    <span class="kw">XAxisRowData</span><span class="kw">=</span><span class="st">"log10_total"</span>,
    <span class="kw">PanelId</span><span class="kw">=</span><span class="fl">1L</span>),
  <span class="fu">GENERATOR</span>(<span class="kw">mode</span><span class="kw">=</span><span class="st">"TSNE"</span>, <span class="kw">ntop</span><span class="kw">=</span><span class="fl">1000</span>,
            <span class="kw">ColumnSelectionSource</span><span class="kw">=</span><span class="st">"ReducedDimensionPlot1"</span>,
            <span class="kw">RowSelectionSource</span><span class="kw">=</span><span class="st">"RowDataPlot1"</span>)
)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-custompca.png" width="992"></p>
<!-- ![](img/customPCA.png) -->
<!-- Here we could mention the custom coverage plot, and link to bulk RNA-seq data -->
</div>
<div id="example-multiple-selections-and-differential-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#example-multiple-selections-and-differential-expression" class="anchor"></a>Example: Multiple selections and differential expression</h3>
<!-- Multiple selections -> DE -->
<p>In the example below, we demonstrate how to transmit multiple selections (active and saved). This information is used to compute the log-fold change for each gene between the active selection and each of the other saved selections.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Copy the code below in your R session in order to define the custom functions.</p>
</blockquote>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">CUSTOM_DIFFEXP</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">se</span>, <span class="no">ri</span>, <span class="no">ci</span>, <span class="no">assay</span><span class="kw">=</span><span class="st">"logcounts"</span>) {
    <span class="no">ri</span> <span class="kw">&lt;-</span> <span class="no">ri</span>$<span class="no">active</span>
    <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">ri</span>)) {
        <span class="no">ri</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">se</span>)
    }
    <span class="no">assayMatrix</span> <span class="kw">&lt;-</span> <span class="fu">assay</span>(<span class="no">se</span>, <span class="no">assay</span>)[<span class="no">ri</span>, , <span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>]

    <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">ci</span>$<span class="no">active</span>) <span class="kw">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ci</span>)<span class="kw">&lt;</span><span class="fl">2L</span>) {
        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">row.names</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="fl">0</span>), <span class="kw">LogFC</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span>(<span class="fl">0</span>))) <span class="co"># dummy value.</span>
    }
    <span class="no">active</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">assayMatrix</span>[,<span class="no">ci</span>$<span class="no">active</span>,<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>])

    <span class="no">all_saved</span> <span class="kw">&lt;-</span> <span class="no">ci</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"saved"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">ci</span>))]
    <span class="no">lfcs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">all_saved</span>))
    <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">lfcs</span>)) {
        <span class="no">saved</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">assayMatrix</span>[,<span class="no">all_saved</span><span class="kw">[[</span><span class="no">i</span>]],<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>])
        <span class="no">lfcs</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="no">active</span> - <span class="no">saved</span>
    }

    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">lfcs</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"LogFC/%i"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">lfcs</span>))
    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">data.frame</span>, <span class="no">lfcs</span>)
}

<span class="no">CUSTOM_HEAT</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">se</span>, <span class="no">ri</span>, <span class="no">ci</span>, <span class="no">assay</span><span class="kw">=</span><span class="st">"logcounts"</span>) {
    <span class="no">everything</span> <span class="kw">&lt;-</span> <span class="fu">CUSTOM_DIFFEXP</span>(<span class="no">se</span>, <span class="no">ri</span>, <span class="no">ci</span>, <span class="kw">assay</span><span class="kw">=</span><span class="no">assay</span>)
    <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">everything</span>) <span class="kw">==</span> <span class="fl">0L</span>) {
        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu">ggplot</span>()) <span class="co"># empty ggplot if no genes reported.</span>
    }

    <span class="no">everything</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">everything</span>)
    <span class="no">top</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">everything</span>)), <span class="kw">decreasing</span><span class="kw">=</span><span class="fl">TRUE</span>), <span class="fl">50</span>)
    <span class="no">topFC</span> <span class="kw">&lt;-</span> <span class="no">everything</span>[<span class="no">top</span>, , <span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>]
    <span class="no">dfFC</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
        <span class="kw">gene</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">topFC</span>), <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">topFC</span>)),
        <span class="kw">contrast</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">topFC</span>), <span class="kw">each</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">topFC</span>)),
        <span class="kw">value</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="no">topFC</span>)
    )
    <span class="fu">ggplot</span>(<span class="no">dfFC</span>, <span class="fu">aes</span>(<span class="no">contrast</span>, <span class="no">gene</span>)) + <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="no">value</span>))
}</pre></body></html></div>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Next, launch an iSEE session with the custom table and plot panels, as well as a Reduced dimension plot from which the column selections for the custom panels are obtained. Select and save multiple subsets of the points in the reduced dimension plot (e.g., clusters) and note how the DE table in the custom panel is updated.</p>
</blockquote>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">TAB_GEN</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/createCustomPanels.html">createCustomTable</a></span>(<span class="no">CUSTOM_DIFFEXP</span>)
<span class="no">HEAT_GEN</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/createCustomPanels.html">createCustomPlot</a></span>(<span class="no">CUSTOM_HEAT</span>)

<span class="no">rdp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(
    <span class="kw">PanelId</span><span class="kw">=</span><span class="fl">1L</span>)

<span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">rdp</span>,
                <span class="fu">TAB_GEN</span>(<span class="kw">ColumnSelectionSource</span><span class="kw">=</span><span class="st">"ReducedDimensionPlot1"</span>),
                <span class="fu">HEAT_GEN</span>(<span class="kw">ColumnSelectionSource</span><span class="kw">=</span><span class="st">"ReducedDimensionPlot1"</span>))
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-custommultipledifferentialexpression.png" width="992"></p>
<!-- ![](img/customMultipleDifferentialExpression.png) -->
<!-- If time is enough: Kev's comparison of reduced dimensionality could be also nice - just to show, maybe, and then link to the iSEE_custom repo -->
<p>More examples of custom panels can be found at <a href="https://github.com/iSEE/iSEE_custom" class="uri">https://github.com/iSEE/iSEE_custom</a> and in the <a href="https://bioconductor.org/packages/3.12/iSEE/vignettes/custom.html">Custom panels</a> vignette.</p>
</div>
</div>
<div id="reproducibility" class="section level2">
<h2 class="hasAnchor">
<a href="#reproducibility" class="anchor"></a>Reproducibility</h2>
<p>The fact that data exploration is done interactively is no reason to forego reproducibility! To this end, <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> lets you export the exact R code used to create each of the currently visible plots.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Close the application and run the following block of code to set up 3 panels, all displaying the t-SNE representation.</p>
</blockquote>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">initial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Column data"</span>,
                       <span class="kw">ColorByColumnData</span> <span class="kw">=</span> <span class="st">"Cluster"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Feature name"</span>,
                       <span class="kw">ColorByFeatureName</span> <span class="kw">=</span> <span class="st">"CD79A"</span>, <span class="kw">ColorByFeatureNameAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">"TSNE"</span>, <span class="kw">ColorBy</span> <span class="kw">=</span> <span class="st">"Feature name"</span>,
                       <span class="kw">ColorByFeatureName</span> <span class="kw">=</span> <span class="st">"CD74"</span>, <span class="kw">ColorByFeatureNameAssay</span> <span class="kw">=</span> <span class="st">"logcounts"</span>)
)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>)</pre></body></html></div>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-reproducibility.png" width="992"></p>
<blockquote>
<p>Then click on the export icon (<i class="fa fa-download fa-1g"></i>) in the top-right corner, and select ‘Extract the R code’. Copy the preamble and the code for the first <em>Reduced dimension plot</em> from the pop-up window. Close the app and paste the code in your R session. Note how this recreates the first reduced dimension plot from the app.</p>
</blockquote>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="co">## The following list of commands will generate the plots created in iSEE</span>
<span class="co">## Copy them into a script or an R session containing your SingleCellExperiment.</span>
<span class="co">## All commands below refer to your SingleCellExperiment object as `se`.</span>

<span class="no">se</span> <span class="kw">&lt;-</span> <span class="no">sce</span>
<span class="no">colormap</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ExperimentColorMap-class.html">ExperimentColorMap</a></span>()
<span class="no">colormap</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/synchronizeAssays.html">synchronizeAssays</a></span>(<span class="no">colormap</span>, <span class="no">se</span>)
<span class="no">all_contents</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co">################################################################################</span>
<span class="co"># Defining brushes</span>
<span class="co">################################################################################</span>

<span class="no">all_active</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">all_active</span><span class="kw">[[</span><span class="st">'ReducedDimensionPlot1'</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">all_active</span><span class="kw">[[</span><span class="st">'ReducedDimensionPlot2'</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">all_active</span><span class="kw">[[</span><span class="st">'ReducedDimensionPlot3'</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co">################################################################################</span>
<span class="co">## Reduced dimension plot 1</span>
<span class="co">################################################################################</span>


<span class="no">red.dim</span> <span class="kw">&lt;-</span> <span class="fu">reducedDim</span>(<span class="no">se</span>, <span class="st">"TSNE"</span>);
<span class="no">plot.data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">X</span><span class="kw">=</span><span class="no">red.dim</span>[, <span class="fl">1</span>], <span class="kw">Y</span><span class="kw">=</span><span class="no">red.dim</span>[, <span class="fl">2</span>], <span class="kw">row.names</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">se</span>));

<span class="no">plot.data</span>$<span class="no">ColorBy</span> <span class="kw">&lt;-</span> <span class="fu">colData</span>(<span class="no">se</span>)[, <span class="st">"Cluster"</span>];

<span class="co"># Avoid visual biases from default ordering by shuffling the points</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2643</span>);
<span class="no">plot.data</span> <span class="kw">&lt;-</span> <span class="no">plot.data</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">plot.data</span>)),,<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>];

<span class="no">dot.plot</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>() +
    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>, <span class="kw">color</span><span class="kw">=</span><span class="no">ColorBy</span>), <span class="kw">alpha</span><span class="kw">=</span><span class="fl">1</span>, <span class="no">plot.data</span>, <span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
    <span class="fu">labs</span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Dimension 1"</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">"Dimension 2"</span>, <span class="kw">color</span><span class="kw">=</span><span class="st">"Cluster"</span>, <span class="kw">title</span><span class="kw">=</span><span class="st">"TSNE"</span>) +
    <span class="fu">coord_cartesian</span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">plot.data</span>$<span class="no">X</span>, <span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>),
        <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">plot.data</span>$<span class="no">Y</span>, <span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>), <span class="kw">expand</span><span class="kw">=</span><span class="fl">TRUE</span>) +
    <span class="fu">scale_color_manual</span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ExperimentColorMap-class.html">colDataColorMap</a></span>(<span class="no">colormap</span>, <span class="st">"Cluster"</span>, <span class="kw">discrete</span><span class="kw">=</span><span class="fl">TRUE</span>)(<span class="fl">14</span>), <span class="kw">na.value</span><span class="kw">=</span><span class="st">'grey50'</span>, <span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>) +
    <span class="fu">scale_fill_manual</span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ExperimentColorMap-class.html">colDataColorMap</a></span>(<span class="no">colormap</span>, <span class="st">"Cluster"</span>, <span class="kw">discrete</span><span class="kw">=</span><span class="fl">TRUE</span>)(<span class="fl">14</span>), <span class="kw">na.value</span><span class="kw">=</span><span class="st">'grey50'</span>, <span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>) +
    <span class="fu">theme_bw</span>() +
    <span class="fu">theme</span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">'bottom'</span>, <span class="kw">legend.box</span><span class="kw">=</span><span class="st">'vertical'</span>, <span class="kw">legend.text</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">9</span>), <span class="kw">legend.title</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">11</span>),
            <span class="kw">axis.text</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">10</span>), <span class="kw">axis.title</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">12</span>), <span class="kw">title</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">12</span>))

<span class="co"># Saving data for transmission</span>
<span class="no">all_contents</span><span class="kw">[[</span><span class="st">'ReducedDimensionPlot1'</span>]] <span class="kw">&lt;-</span> <span class="no">plot.data</span></pre></body></html></div>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">dot.plot</span></pre></body></html></div>
<p><img src="iSEE-lab_files/figure-html/unnamed-chunk-94-1.png" width="700"></p>
</div>
<div id="sharing-tours" class="section level2">
<h2 class="hasAnchor">
<a href="#sharing-tours" class="anchor"></a>Sharing and communication</h2>
<p>One important aspect of visualization is the ability to share your insights with others. A powerful way of easily getting people unfamiliar with your data up to speed is to provide a walk-through of the interface and the different types of plots that are displayed. With <em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em>, this can be achieved using <em>tours</em>. To configure a tour, you need to create a text file with two columns; named <code>element</code> and <code>intro</code>, with the former describing the UI element to highlight in each step, and the latter providing the descriptive text that will be displayed.</p>
<blockquote>
<p><i class="fa fa-wrench fa-2x"></i> <strong>Action:</strong> Run the code below to generate a data frame configuring a tour for the app generated in the previous step. Then launch a new instance, providing the data frame to the <code>tour</code> argument.</p>
</blockquote>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="no">tour</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">element</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
        <span class="st">"#Welcome"</span>,
        <span class="st">"#ReducedDimensionPlot1"</span>,
        <span class="st">"#ReducedDimensionPlot2"</span>,
        <span class="st">"#Conclusion"</span>),
    <span class="kw">intro</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
        <span class="st">"Welcome to this tour!"</span>,
        <span class="st">"This is the first reduced dimension plot"</span>,
        <span class="st">"And here is the second one"</span>,
        <span class="st">"Thank you for taking this tour!"</span>),
    <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span>(<span class="no">sce</span>, <span class="kw">initial</span> <span class="kw">=</span> <span class="no">initial</span>, <span class="kw">tour</span> <span class="kw">=</span> <span class="no">tour</span>)</pre></body></html></div>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-tour.png" width="992"></p>
<p>To see an example of a more complex tour in action, visit <a href="https://marionilab.cruk.cam.ac.uk/iSEE_pbmc4k/" class="uri">https://marionilab.cruk.cam.ac.uk/iSEE_pbmc4k/</a>. The code used to create this app and the associated tour is available from <a href="https://github.com/iSEE/iSEE2018/tree/master/tours/pbmc4k" class="uri">https://github.com/iSEE/iSEE2018/tree/master/tours/pbmc4k</a>.</p>
<!-- If there is enough time: draft a mini tour live (challenging: anchors might be tricky - rewarding: once it works, it is surely a OOOH thing) -->
</div>
</div>
<div id="modes-and-additional-panels" class="section level1">
<h1 class="hasAnchor">
<a href="#modes-and-additional-panels" class="anchor"></a>Modes and additional panels</h1>
<p>The <em><a href="https://bioconductor.org/packages/3.12/iSEEu">iSEEu</a></em> (“iSEE universe”) Bioconductor package defines additional custom panels and predefined ‘modes’ (startup configurations) that may be useful for specific applications. Here we illustrate the use of the <em>reduced dimension</em> mode, which will start an application with one reduced dimension panel for each reduced dimension representation in the input object.</p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">iSEEu</span>)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEEu/man/modeReducedDim.html">modeReducedDim</a></span>(<span class="no">sce</span>)</pre></body></html></div>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html">runApp</a></span>(<span class="no">app</span>)</pre></body></html></div>
<p><img src="screenshots/isee-iseeu-modereduceddim.png" width="992"></p>
<p>If you have ideas about additional panels and/or modes that might be useful, we welcome issues and pull requests at <a href="https://github.com/iSEE/iSEEu" class="uri">https://github.com/iSEE/iSEEu</a>.</p>
</div>
<div id="more-resources" class="section level1">
<h1 class="hasAnchor">
<a href="#more-resources" class="anchor"></a>Additional resources</h1>
<ul>
<li>The <code>iSEE</code> bookdown book: <a href="https://isee.github.io/iSEE-book/" class="uri">https://isee.github.io/iSEE-book/</a>
</li>
<li>Bioconductor landing page: <a href="https://bioconductor.org/packages/iSEE/" class="uri">https://bioconductor.org/packages/iSEE/</a>
</li>
<li>Publication (F1000Research, 2018): <a href="https://f1000research.com/articles/7-741/v1" class="uri">https://f1000research.com/articles/7-741/v1</a>
</li>
<li>Deployed examples: <a href="https://marionilab.cruk.cam.ac.uk/" class="uri">https://marionilab.cruk.cam.ac.uk/</a>, code at <a href="https://github.com/iSEE/iSEE2018" class="uri">https://github.com/iSEE/iSEE2018</a>
<ul>
<li>Further deployments in the <a href="https://github.com/iSEE/iSEE_instances" class="uri">https://github.com/iSEE/iSEE_instances</a> repo</li>
<li>
<em><a href="https://bioconductor.org/packages/3.12/iSEE">iSEE</a></em> in production: <a href="http://www.teichlab.org/singlecell-treg" class="uri">http://www.teichlab.org/singlecell-treg</a>
</li>
</ul>
</li>
<li>Custom panel examples: <a href="https://github.com/iSEE/iSEE_custom" class="uri">https://github.com/iSEE/iSEE_custom</a>
</li>
<li>Development version (bug reports etc): <a href="https://github.com/iSEE/iSEE" class="uri">https://github.com/iSEE/iSEE</a>
</li>
</ul>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 4.0.0 (2020-04-24)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 18.04.4 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] parallel  stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] iSEEu_1.1.2                 iSEE_2.1.10                </span>
<span class="co">#&gt;  [3] BiocSingular_1.5.0          scran_1.17.9               </span>
<span class="co">#&gt;  [5] scater_1.17.3               ggplot2_3.3.2              </span>
<span class="co">#&gt;  [7] TENxPBMCData_1.7.0          HDF5Array_1.17.3           </span>
<span class="co">#&gt;  [9] rhdf5_2.33.7                SingleCellExperiment_1.11.6</span>
<span class="co">#&gt; [11] SummarizedExperiment_1.19.6 DelayedArray_0.15.7        </span>
<span class="co">#&gt; [13] matrixStats_0.56.0          Matrix_1.2-18              </span>
<span class="co">#&gt; [15] Biobase_2.49.0              GenomicRanges_1.41.5       </span>
<span class="co">#&gt; [17] GenomeInfoDb_1.25.8         IRanges_2.23.10            </span>
<span class="co">#&gt; [19] S4Vectors_0.27.12           BiocGenerics_0.35.4        </span>
<span class="co">#&gt; [21] BiocStyle_2.17.0           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] backports_1.1.8               circlize_0.4.10              </span>
<span class="co">#&gt;   [3] AnnotationHub_2.21.1          BiocFileCache_1.13.0         </span>
<span class="co">#&gt;   [5] igraph_1.2.5                  shinydashboard_0.7.1         </span>
<span class="co">#&gt;   [7] splines_4.0.0                 BiocParallel_1.23.2          </span>
<span class="co">#&gt;   [9] digest_0.6.25                 htmltools_0.5.0              </span>
<span class="co">#&gt;  [11] viridis_0.5.1                 magrittr_1.5                 </span>
<span class="co">#&gt;  [13] memoise_1.1.0                 cluster_2.1.0                </span>
<span class="co">#&gt;  [15] limma_3.45.9                  ComplexHeatmap_2.5.3         </span>
<span class="co">#&gt;  [17] pkgdown_1.5.1                 colorspace_1.4-1             </span>
<span class="co">#&gt;  [19] blob_1.2.1                    rappdirs_0.3.1               </span>
<span class="co">#&gt;  [21] xfun_0.15                     dplyr_1.0.0                  </span>
<span class="co">#&gt;  [23] crayon_1.3.4                  RCurl_1.98-1.2               </span>
<span class="co">#&gt;  [25] jsonlite_1.7.0                glue_1.4.1                   </span>
<span class="co">#&gt;  [27] gtable_0.3.0                  zlibbioc_1.35.0              </span>
<span class="co">#&gt;  [29] XVector_0.29.3                GetoptLong_1.0.2             </span>
<span class="co">#&gt;  [31] Rhdf5lib_1.11.3               shape_1.4.4                  </span>
<span class="co">#&gt;  [33] scales_1.1.1                  DBI_1.1.0                    </span>
<span class="co">#&gt;  [35] edgeR_3.31.4                  miniUI_0.1.1.1               </span>
<span class="co">#&gt;  [37] Rcpp_1.0.5                    viridisLite_0.3.0            </span>
<span class="co">#&gt;  [39] xtable_1.8-4                  clue_0.3-57                  </span>
<span class="co">#&gt;  [41] dqrng_0.2.1                   bit_1.1-15.2                 </span>
<span class="co">#&gt;  [43] rsvd_1.0.3                    DT_0.14                      </span>
<span class="co">#&gt;  [45] htmlwidgets_1.5.1             httr_1.4.1                   </span>
<span class="co">#&gt;  [47] FNN_1.1.3                     RColorBrewer_1.1-2           </span>
<span class="co">#&gt;  [49] shinyAce_0.4.1                ellipsis_0.3.1               </span>
<span class="co">#&gt;  [51] farver_2.0.3                  pkgconfig_2.0.3              </span>
<span class="co">#&gt;  [53] scuttle_0.99.11               uwot_0.1.8                   </span>
<span class="co">#&gt;  [55] dbplyr_1.4.4                  locfit_1.5-9.4               </span>
<span class="co">#&gt;  [57] tidyselect_1.1.0              labeling_0.3                 </span>
<span class="co">#&gt;  [59] rlang_0.4.7                   later_1.1.0.1                </span>
<span class="co">#&gt;  [61] AnnotationDbi_1.51.1          munsell_0.5.0                </span>
<span class="co">#&gt;  [63] BiocVersion_3.12.0            tools_4.0.0                  </span>
<span class="co">#&gt;  [65] generics_0.0.2                RSQLite_2.2.0                </span>
<span class="co">#&gt;  [67] ExperimentHub_1.15.0          rintrojs_0.2.2               </span>
<span class="co">#&gt;  [69] evaluate_0.14                 stringr_1.4.0                </span>
<span class="co">#&gt;  [71] fastmap_1.0.1                 yaml_2.2.1                   </span>
<span class="co">#&gt;  [73] knitr_1.29                    bit64_0.9-7.1                </span>
<span class="co">#&gt;  [75] fs_1.4.2                      purrr_0.3.4                  </span>
<span class="co">#&gt;  [77] nlme_3.1-148                  mime_0.9                     </span>
<span class="co">#&gt;  [79] compiler_4.0.0                beeswarm_0.2.3               </span>
<span class="co">#&gt;  [81] curl_4.3                      png_0.1-7                    </span>
<span class="co">#&gt;  [83] interactiveDisplayBase_1.27.5 tibble_3.0.3                 </span>
<span class="co">#&gt;  [85] statmod_1.4.34                stringi_1.4.6                </span>
<span class="co">#&gt;  [87] desc_1.2.0                    RSpectra_0.16-0              </span>
<span class="co">#&gt;  [89] lattice_0.20-41               shinyjs_1.1                  </span>
<span class="co">#&gt;  [91] vctrs_0.3.2                   pillar_1.4.6                 </span>
<span class="co">#&gt;  [93] lifecycle_0.2.0               rhdf5filters_1.1.2           </span>
<span class="co">#&gt;  [95] BiocManager_1.30.10           GlobalOptions_0.1.2          </span>
<span class="co">#&gt;  [97] BiocNeighbors_1.7.0           bitops_1.0-6                 </span>
<span class="co">#&gt;  [99] irlba_2.3.3                   httpuv_1.5.4                 </span>
<span class="co">#&gt; [101] R6_2.4.1                      promises_1.1.1               </span>
<span class="co">#&gt; [103] gridExtra_2.3                 vipor_0.4.5                  </span>
<span class="co">#&gt; [105] colourpicker_1.0              MASS_7.3-51.6                </span>
<span class="co">#&gt; [107] assertthat_0.2.1              rprojroot_1.3-2              </span>
<span class="co">#&gt; [109] rjson_0.2.20                  shinyWidgets_0.5.3           </span>
<span class="co">#&gt; [111] withr_2.2.0                   GenomeInfoDbData_1.2.3       </span>
<span class="co">#&gt; [113] mgcv_1.8-31                   grid_4.0.0                   </span>
<span class="co">#&gt; [115] beachmat_2.5.0                rmarkdown_2.3                </span>
<span class="co">#&gt; [117] DelayedMatrixStats_1.11.1     Rtsne_0.15                   </span>
<span class="co">#&gt; [119] shiny_1.5.0                   ggbeeswarm_0.6.0</span></pre></body></html></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Bremner1994-hintonplots">
<p>Bremner, Frederick J, Stephen J Gotts, and Dina L Denham. 1994. “Hinton Diagrams: Viewing Connection Strengths in Neural Networks.” <em>Behav. Res. Methods Instrum. Comput.</em> 26 (2): 215–18.</p>
</div>
<div id="ref-Hinton1991-hintondiagram">
<p>Hinton, Geoffrey E, and Tim Shallice. 1991. “Lesioning an Attractor Network: Investigations of Acquired Dyslexia.” <em>Psychological Review</em> 98 (1): 74–95.</p>
</div>
<div id="ref-Huber2015-orchestrating">
<p>Huber, Wolfgang, Vincent J Carey, Robert Gentleman, Simon Anders, Marc Carlson, Benilton S Carvalho, Hector Corrada Bravo, et al. 2015. “Orchestrating High-Throughput Genomic Analysis with Bioconductor.” <em>Nat. Methods</em> 12 (2): 115–21.</p>
</div>
<div id="ref-Rue-Albrecht2018-isee">
<p>Rue-Albrecht, Kevin, Federico Marini, Charlotte Soneson, and Aaron T L Lun. 2018. “iSEE: Interactive SummarizedExperiment Explorer.” <em>F1000Res.</em> 7 (June).</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>University of Oxford, Oxford, UK<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Friedrich Miescher Institute for Biomedical Research and SIB Swiss Institute of Bioinformatics<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Institute of Medical Biostatistics, Epidemiology and Informatics (IMBEI), Mainz and Center for Thrombosis and Hemostasis (CTH), Mainz<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Genentech, Bioinformatics and Computational Biology<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Federico Marini, Charlotte Soneson, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
